<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converter="clr-namespace:Test.DragControl.Utils"
    xmlns:input="clr-namespace:System.Windows.Input;assembly=PresentationCore"
    xmlns:local="clr-namespace:Test.DragControl.Controls">
    <converter:BoolTakebackConverter x:Key="BoolTakebackConverter" />
    <converter:ContentHeightConverter x:Key="ContentHeightConverter" />

    <Style x:Key="HorizontalSeparatorStyle" TargetType="{x:Type Separator}">
        <Setter Property="Background" Value="#dfdddb" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Height" Value="1" />
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Separator}">
                    <Line
                        Stretch="Fill"
                        Stroke="{TemplateBinding Background}"
                        StrokeEndLineCap="Square"
                        StrokeStartLineCap="Square"
                        StrokeThickness="{TemplateBinding Height}"
                        X2="1" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style
        x:Key="VerticalSeparatorStyle"
        BasedOn="{StaticResource {x:Type Separator}}"
        TargetType="{x:Type Separator}">
        <Setter Property="Height" Value="10" />
        <Setter Property="Width" Value="15" />
        <Setter Property="LayoutTransform">
            <Setter.Value>
                <TransformGroup>
                    <TransformGroup.Children>
                        <TransformCollection>
                            <RotateTransform Angle="90" />
                        </TransformCollection>
                    </TransformGroup.Children>
                </TransformGroup>
            </Setter.Value>
        </Setter>
    </Style>

    <SolidColorBrush x:Key="TextBox.Static.Border" Color="#FFABAdB3" />
    <SolidColorBrush x:Key="TextBox.MouseOver.Border" Color="#FF7EB4EA" />
    <SolidColorBrush x:Key="TextBox.Focus.Border" Color="#FF569DE5" />

    <Style TargetType="{x:Type local:SuperTextBox}">
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
        <Setter Property="BorderBrush" Value="{StaticResource TextBox.Static.Border}" />
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="TextWrapping" Value="Wrap" />
        <Setter Property="AcceptsReturn" Value="True" />
        <Setter Property="AcceptsTab" Value="True" />
        <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="HorizontalScrollBarVisibility" Value="Disabled" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:SuperTextBox}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock
                            x:Name="title"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Left"
                            FontSize="16"
                            Text="{Binding Title, RelativeSource={RelativeSource TemplatedParent}}" />
                        <Button
                            x:Name="PART_ShowButton"
                            Width="80"
                            Height="26"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Right"
                            Content="Show" />
                        <Button
                            x:Name="PART_AddButton"
                            Width="80"
                            Height="26"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Right"
                            Content="Add"
                            Visibility="Collapsed" />

                        <StackPanel Grid.Row="1" Orientation="Vertical">
                            <Border
                                x:Name="border"
                                Width="{Binding Width, RelativeSource={RelativeSource TemplatedParent}}"
                                Padding="10"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                                <Border.Height>
                                    <MultiBinding Converter="{StaticResource ContentHeightConverter}">
                                        <Binding Path="Height" RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding ElementName="bottomToolBar" Path="ActualHeight" />
                                        <Binding ElementName="title" Path="ActualHeight" />
                                    </MultiBinding>
                                </Border.Height>
                                <Grid>
                                    <ScrollViewer
                                        x:Name="PART_ContentHost"
                                        HorizontalScrollBarVisibility="Hidden"
                                        VerticalScrollBarVisibility="Hidden" />
                                    <!--  水印  -->
                                    <TextBlock
                                        x:Name="placeHolder"
                                        HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                        VerticalAlignment="Top"
                                        Foreground="Gray"
                                        Text="{TemplateBinding Tag}"
                                        TextWrapping="Wrap"
                                        Visibility="Collapsed" />
                                    <TextBlock
                                        x:Name="dialoguePlaceHolder"
                                        HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                        VerticalAlignment="Top"
                                        Foreground="Gray"
                                        TextWrapping="Wrap"
                                        Visibility="Collapsed">
                                        <Run Text="{TemplateBinding Tag}" />
                                        <LineBreak />
                                        <Run Text="W:" />
                                        <LineBreak />
                                        <Run Text="M:" />
                                        <LineBreak />
                                        <Run Text="w:" />
                                        <LineBreak />
                                        <Run Text="m:" />
                                    </TextBlock>
                                </Grid>

                            </Border>
                            <Border
                                x:Name="bottomToolBar"
                                Width="{Binding Width, RelativeSource={RelativeSource TemplatedParent}}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                                <StackPanel Orientation="Horizontal">
                                    <StackPanel x:Name="readCount" Orientation="Horizontal">
                                        <RadioButton Content="1" IsChecked="{Binding IsReadOneTime, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" />
                                        <RadioButton Content="2" IsChecked="{Binding IsReadOneTime, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, Converter={StaticResource BoolTakebackConverter}}" />
                                        <Separator Style="{StaticResource VerticalSeparatorStyle}" />
                                    </StackPanel>
                                    <StackPanel x:Name="voiceType" Orientation="Horizontal">
                                        <RadioButton Content="man" IsChecked="{Binding IsMaleVoice, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" />
                                        <RadioButton Content="femal" IsChecked="{Binding IsMaleVoice, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, Converter={StaticResource BoolTakebackConverter}}" />
                                        <Separator Style="{StaticResource VerticalSeparatorStyle}" />
                                    </StackPanel>
                                    <Button
                                        x:Name="PART_PlayButton"
                                        Width="50"
                                        Command="{Binding PlayCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                        CommandParameter="{Binding CommandParameter, RelativeSource={RelativeSource TemplatedParent}}"
                                        Content="play" />
                                    <StackPanel
                                        Margin="10,0,0,0"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <Slider
                                            x:Name="PART_Slider"
                                            Width="200"
                                            Height="10"
                                            Maximum="100"
                                            Minimum="0"
                                            Value="{Binding AudioProgressValue, RelativeSource={RelativeSource TemplatedParent}}" />
                                        <TextBlock
                                            Margin="10,0,0,0"
                                            FontSize="16"
                                            Text="{Binding AudioCurrentTime, RelativeSource={RelativeSource TemplatedParent}, StringFormat={}{0:hh\\:mm\\:ss}}"
                                            ToolTip="当前播放时长" />
                                        <TextBlock FontSize="16" Text="/" />
                                        <TextBlock
                                            FontSize="16"
                                            Text="{Binding AudioTotalTime, RelativeSource={RelativeSource TemplatedParent}, StringFormat={}{0:hh\\:mm\\:ss}}"
                                            ToolTip="总时长" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!--  只有在PART_ShowButton点击时才显示  -->
                        <Popup
                            x:Name="PART_PopupToolBar"
                            Placement="Left"
                            PlacementTarget="{Binding ElementName=PART_ShowButton}"
                            PopupAnimation="Fade"
                            StaysOpen="False">
                            <StackPanel Grid.Row="1" Orientation="Horizontal">
                                <Button
                                    x:Name="PART_RemoveButton"
                                    Width="80"
                                    Height="26"
                                    Content="Remove" />
                                <Button
                                    x:Name="PART_MoveUpButton"
                                    Width="80"
                                    Height="26"
                                    Content="MoveUp" />
                                <Button
                                    x:Name="PART_MoveDownButton"
                                    Width="90"
                                    Height="26"
                                    Content="MoveDown" />
                            </StackPanel>
                        </Popup>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="border" Property="Opacity" Value="0.56" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource TextBox.MouseOver.Border}" />
                        </Trigger>
                        <Trigger Property="IsReadOnly" Value="True">
                            <Setter TargetName="PART_AddButton" Property="Visibility" Value="Visible" />
                            <Setter TargetName="bottomToolBar" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="PART_ShowButton" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="IsReadOnly" Value="False">
                            <Setter TargetName="PART_AddButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="bottomToolBar" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <DataTrigger Binding="{Binding TextBoxType, RelativeSource={RelativeSource self}}" Value="1">
                            <Setter TargetName="voiceType" Property="Visibility" Value="Collapsed" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding TextBoxType, RelativeSource={RelativeSource self}}" Value="2">
                            <Setter TargetName="readCount" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="voiceType" Property="Visibility" Value="Collapsed" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource self}}" Value="">
                            <Setter TargetName="placeHolder" Property="Visibility" Value="Visible" />
                        </DataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Text, RelativeSource={RelativeSource self}}" Value="" />
                                <Condition Binding="{Binding TextBoxType, RelativeSource={RelativeSource self}}" Value="1" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="dialoguePlaceHolder" Property="Visibility" Value="Visible" />
                        </MultiDataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type local:SimpleTextBox}">
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
        <Setter Property="BorderBrush" Value="#EDF0F2 " />
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="TextWrapping" Value="NoWrap" />
        <Setter Property="input:InputMethod.IsInputMethodEnabled" Value="False" />
        <Setter Property="VerticalScrollBarVisibility" Value="Disabled" />
        <Setter Property="HorizontalScrollBarVisibility" Value="Disabled" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:SimpleTextBox}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock
                            x:Name="title"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Left"
                            FontSize="16"
                            Text="{Binding Title, RelativeSource={RelativeSource TemplatedParent}}" />
                        <Button
                            x:Name="PART_ShowButton"
                            Width="80"
                            Height="26"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Right"
                            Content="Show" />
                        <Button
                            x:Name="PART_AddButton"
                            Width="80"
                            Height="26"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Right"
                            Content="Add"
                            Visibility="Collapsed" />

                        <Border
                            x:Name="border"
                            Grid.Row="1"
                            Width="{Binding Width, RelativeSource={RelativeSource TemplatedParent}}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            SnapsToDevicePixels="True">
                            <Border.Height>
                                <MultiBinding Converter="{StaticResource ContentHeightConverter}">
                                    <Binding Path="Height" RelativeSource="{RelativeSource TemplatedParent}" />
                                    <Binding ElementName="title" Path="ActualHeight" />
                                </MultiBinding>
                            </Border.Height>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    Text="设置:" />

                                <Border
                                    Grid.Column="1"
                                    Width="76"
                                    Height="24"
                                    Margin="10,0"
                                    Padding="5"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4">
                                    <Grid>
                                        <ScrollViewer
                                            x:Name="PART_ContentHost"
                                            Focusable="false"
                                            HorizontalScrollBarVisibility="Hidden"
                                            VerticalScrollBarVisibility="Hidden" />
                                        <!--  水印  -->
                                        <TextBlock
                                            x:Name="placeHolder"
                                            Grid.Column="1"
                                            HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                            VerticalAlignment="Center"
                                            Foreground="Gray"
                                            Text="{TemplateBinding Tag}"
                                            TextWrapping="Wrap"
                                            Visibility="Collapsed" />
                                    </Grid>
                                </Border>

                                <TextBlock
                                    Grid.Column="2"
                                    VerticalAlignment="Center"
                                    Text="秒" />
                            </Grid>

                        </Border>

                        <!--  只有在PART_ShowButton点击时才显示  -->
                        <Popup
                            x:Name="PART_PopupToolBar"
                            Placement="Left"
                            PlacementTarget="{Binding ElementName=PART_ShowButton}"
                            PopupAnimation="Fade"
                            StaysOpen="False">
                            <StackPanel Grid.Row="1" Orientation="Horizontal">
                                <Button
                                    x:Name="PART_RemoveButton"
                                    Width="80"
                                    Height="26"
                                    Content="Remove" />
                                <Button
                                    x:Name="PART_MoveUpButton"
                                    Width="80"
                                    Height="26"
                                    Content="MoveUp" />
                                <Button
                                    x:Name="PART_MoveDownButton"
                                    Width="90"
                                    Height="26"
                                    Content="MoveDown" />
                            </StackPanel>
                        </Popup>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="border" Property="Opacity" Value="0.56" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource TextBox.MouseOver.Border}" />
                        </Trigger>
                        <Trigger Property="IsReadOnly" Value="True">
                            <Setter TargetName="PART_AddButton" Property="Visibility" Value="Visible" />
                            <Setter TargetName="PART_ShowButton" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="IsReadOnly" Value="False">
                            <Setter TargetName="PART_AddButton" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource self}}" Value="">
                            <Setter TargetName="placeHolder" Property="Visibility" Value="Visible" />
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Validation.HasError" Value="true">
                <Setter Property="ToolTip" Value="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=(Validation.Errors)[0].ErrorContent}" />
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
