<Window x:Class="Test.AttachedProperties.MainWindow2"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Test.AttachedProperties"
        xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors"
        mc:Ignorable="d"
        Title="MainWindow"
        Height="450"
        Width="800">
    <Window.Resources>
        <Storyboard x:Key="begin"
                    RepeatBehavior="Forever"
                    Storyboard.TargetProperty="Height"
                    Timeline.DesiredFrameRate="60">
            <DoubleAnimation Storyboard.TargetName="rec1"
                             From="1"
                             To="36"
                             BeginTime="0:0:0.0"
                             Duration="0:0:0.3"
                             AutoReverse="True" />
            <DoubleAnimation Storyboard.TargetName="rec2"
                             From="36"
                             To="1"
                             BeginTime="0:0:0.1"
                             Duration="0:0:0.3"
                             AutoReverse="True" />
            <DoubleAnimation Storyboard.TargetName="rec3"
                             From="10"
                             To="36"
                             BeginTime="0:0:0.2"
                             Duration="0:0:0.3"
                             AutoReverse="True" />
        </Storyboard>
    </Window.Resources>

    <Button Width="100" Height="50">
        <Button.Style>
            <Style TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <StackPanel Orientation="Horizontal"
                                        Height="36"
                                        HorizontalAlignment="Center">
                                <Rectangle Name="rec1"
                                           Fill="Black"
                                           Width="5"
                                           Height="16"
                                           VerticalAlignment="Bottom" />
                                <Rectangle Name="rec2"
                                           Fill="Black"
                                           Width="5"
                                           Height="36"
                                           Margin="2,0"
                                           VerticalAlignment="Bottom" />
                                <Rectangle Name="rec3"
                                           Fill="Black"
                                           Width="5"
                                           Height="6"
                                           VerticalAlignment="Bottom" />
                            </StackPanel>
                            <ControlTemplate.Triggers>
                                <!--<EventTrigger RoutedEvent="ButtonBase.MouseEnter">
                                    <EventTrigger.Actions>
                                        <BeginStoryboard Storyboard="{StaticResource begin}" />
                                    </EventTrigger.Actions>
                                </EventTrigger>-->
                                <!--<Trigger Property="Visibility" Value="Visible">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard x:Name="paly" Storyboard="{StaticResource begin}" />
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <StopStoryboard BeginStoryboardName="paly" />
                                    </Trigger.ExitActions>
                                </Trigger>-->
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Visibility}" Value="Visible">
                                    <DataTrigger.EnterActions>
                                        <BeginStoryboard x:Name="paly" Storyboard="{StaticResource begin}" />
                                    </DataTrigger.EnterActions>
                                    <DataTrigger.ExitActions>
                                        <StopStoryboard BeginStoryboardName="paly" />
                                    </DataTrigger.ExitActions>
                                </DataTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Button.Style>
    </Button>
</Window>
